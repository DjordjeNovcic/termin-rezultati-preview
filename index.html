<!DOCTYPE html>
<html lang="sr">
   <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Rezultati</title>
      <script type="module" src="firebase.mjs"></script>
      <style>
         @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap');
         :root {
         --bg-a: #ecf6ff;
         --bg-b: #f5fffb;
         --ink: #0f172a;
         --muted: #5b667a;
         --brand: #1178c8;
         --brand-2: #0ea5a6;
         --card-border: #dce7f5;
         --ring: rgba(17, 120, 200, 0.16);
         --focus: #0b66b8;
         }
         html {
         scroll-behavior: smooth;
         }
         * {
         box-sizing: border-box;
         margin: 0;
         padding: 0;
         }
         body {
         font-family: 'Plus Jakarta Sans', 'Avenir Next', 'Segoe UI', sans-serif;
         background:
           radial-gradient(1200px 420px at 10% -10%, rgba(17, 120, 200, 0.15), transparent 55%),
           radial-gradient(1000px 360px at 100% 0%, rgba(14, 165, 166, 0.12), transparent 45%),
           linear-gradient(180deg, var(--bg-a) 0%, var(--bg-b) 100%);
         min-height: 100vh;
         padding: 30px 15px;
         color: var(--ink);
         }
         .container {
         max-width: 980px;
         margin: 0 auto;
         }
         /* HEADER */
         header {
         background: white;
         border-radius: 16px;
         padding: 25px 35px;
         margin-bottom: 35px;
         box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
         text-align: center;
         transition: transform 0.3s ease, box-shadow 0.3s ease;
         animation: riseIn 0.45s ease both;
         }
         header:hover {
         transform: translateY(-2px);
         box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
         }
         .logo {
         font-size: 32px;
         font-weight: bold;
         background: linear-gradient(120deg, #0b66b8 0%, #0ea5a6 100%);
         -webkit-background-clip: text;
         -webkit-text-fill-color: transparent;
         background-clip: text;
         margin-bottom: 20px;
         }
         .header-nav {
         display: flex;
         gap: 12px;
         align-items: center;
         justify-content: center;
         }
         .hero-subtitle {
         font-size: 13px;
         color: #5b667a;
         margin-bottom: 18px;
         }
         .team-link {
         padding: 12px 20px;
         border: none;
         border-radius: 10px;
         font-size: 14px;
         font-weight: 600;
         cursor: pointer;
         transition: all 0.3s ease;
         text-decoration: none;
         display: inline-flex;
         align-items: center;
         gap: 6px;
         white-space: nowrap;
         justify-content: center;
         text-align: center;
         }
         /* LINEUP FIELD */
         .lineup-field {
         position: relative;
         width: 100%;
         max-width: 420px;
         margin: 0 auto;
         aspect-ratio: 2 / 3;
         background: url('field.png') center / cover no-repeat;
         border-radius: 10px;
         box-shadow: inset 0 0 0 2px rgba(255,255,255,0.8);
         }
         .lineup-team {
         position: absolute;
         width: 100%;
         height: 50%;
         left: 0;
         }
         .lineup-team.red { top: 0; }
         .lineup-team.blue { bottom: 0; transform: rotate(180deg); }
         .player {
         position: absolute;
         transform: translate(-50%, -50%);
         font-size: 11px;
         font-weight: 600;
         padding: 4px 6px;
         border-radius: 6px;
         white-space: nowrap;
         box-shadow: 0 2px 6px rgba(0,0,0,0.25);
         }
         .player.red {
         background: #ffe5e5;
         color: #d63031;
         }
         .player.blue {
         background: #e5f0ff;
         color: #0984e3;
         }
         /* positions */
         .pos-gk   { top: 85%; left: 50%; }
         .pos-dl   { top: 65%; left: 20%; }
         .pos-dc1  { top: 65%; left: 40%; }
         .pos-dc2  { top: 65%; left: 60%; }
         .pos-dr   { top: 65%; left: 80%; }
         .team-link.red {
         background: linear-gradient(135deg, #ffe5e5 0%, #ffcccc 100%);
         color: #d63031;
         border: 2px solid #d63031;
         }
         .team-link.red:hover {
         background: #d63031;
         color: white;
         transform: translateY(-2px);
         box-shadow: 0 4px 12px rgba(214, 48, 49, 0.3);
         }
         .team-link.blue {
         background: linear-gradient(135deg, #e5f0ff 0%, #cce5ff 100%);
         color: #0984e3;
         border: 2px solid #0984e3;
         }
         .team-link.blue:hover {
         background: #0984e3;
         color: white;
         transform: translateY(-2px);
         box-shadow: 0 4px 12px rgba(9, 132, 227, 0.3);
         }
         #loginBtn {
         padding: 12px 24px;
         border: none;
         border-radius: 10px;
         font-size: 14px;
         font-weight: 600;
         cursor: pointer;
         transition: all 0.3s ease;
         background: linear-gradient(135deg, #0b66b8 0%, #0ea5a6 100%);
         color: white;
         box-shadow: 0 8px 20px var(--ring);
         }
         #loginBtn:hover {
         background: linear-gradient(135deg, #095ca8 0%, #0c9597 100%);
         transform: translateY(-2px);
         box-shadow: 0 10px 24px var(--ring);
         }
         /* MAIN CARD */
         .card {
         background: white;
         border-radius: 16px;
         padding: 0;
         margin-bottom: 30px;
         box-shadow: 0 14px 32px rgba(15, 23, 42, 0.08);
         border: 1px solid var(--card-border);
         overflow: hidden;
         transition: transform 0.3s ease, box-shadow 0.3s ease;
         animation: riseIn 0.45s ease both;
         }
         .card:nth-of-type(2) { animation-delay: 0.05s; }
         .card:nth-of-type(3) { animation-delay: 0.1s; }
         .scorers-table-wrapper tbody tr {
         border-bottom: 1px solid rgba(0,0,0,0.04);
         }
         .card:hover {
         transform: translateY(-4px);
         box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
         }
         /* Section headers with gradient */
         .card-header {
         padding: 22px 32px;
         background: linear-gradient(180deg, #ffffff 0%, #f6f7fb 100%);
         color: var(--ink);
         font-size: 22px;
         font-weight: 800;
         border-bottom: 1px solid #e3e6f3;
         }
         .card-header::after {
         content: "";
         display: block;
         width: 48px;
         height: 3px;
         background: linear-gradient(120deg, #0b66b8, #0ea5a6);
         margin: 10px auto 0;
         border-radius: 2px;
         }
         .card-content {
         padding: 30px 35px 35px;
         }
         h1, h2 {
         font-size: 24px;
         font-weight: 700;
         margin: 0;
         text-align: center;
         }
         .modal-actions {
         display: flex;
         gap: 8px;
         margin-bottom: 12px;
         }
         .modal-btn {
         border: none;
         padding: 6px 12px;
         font-size: 12px;
         font-weight: 600;
         border-radius: 6px;
         cursor: pointer;
         background: #f1f3f5;
         color: #333;
         }
         .modal-btn.active {
         background: linear-gradient(135deg, #0b66b8, #0ea5a6);
         color: white;
         }
         /* MATCH BOX */
         .match-box {
         padding: 28px;
         border-radius: 12px;
         background: linear-gradient(135deg, #ffffff 0%, #f8fbff 100%);
         border: 1px solid var(--card-border);
         }
         /* === SCORERS TABLE UX IMPROVEMENTS === */
         /* Ime igraca - jaƒçi fokus */
         .scorers-table-wrapper td:first-child {
         font-weight: 600;
         text-align: left;
         }
         /* Tim - sekundarna informacija */
         .scorers-table-wrapper td:nth-child(2) {
         font-size: 12px;
         opacity: 0.7;
         }
         /* Golovi - primarni signal */
         .scorers-table-wrapper td:last-child {
         font-size: 16px;
         font-weight: 800;
         color: #5f6eea;
         }
         /* Recent match boxes - lighter styling */
         .recent-matches-content .match-box {
         background: transparent;
         border: none;
         border-bottom: 2px solid #f0f0f0;
         border-radius: 0;
         padding: 20px 0;
         margin-bottom: 0;
         transition: background 0.2s ease;
         }
         .recent-matches-content .match-box:hover {
         background: rgba(102, 126, 234, 0.02);
         }
         .recent-matches-content .match-box:last-of-type {
         border-bottom: none;
         }
         .match-info {
         opacity: 0.8;
         margin-bottom: 18px;
         text-align: center;
         font-size: 14px;
         color: #636e72;
         }
         .match-links {
         display: flex;
         gap: 8px;
         justify-content: center;
         margin-top: 12px;
         flex-wrap: wrap;
         }
         .team-logo {
         width: 140px;
         height: 140px;
         object-fit: contain;
         transition: transform 0.3s ease;
         }
         .team-logo:hover {
         transform: scale(1.1);
         }
         .team-name {
         font-weight: bold;
         margin-top: 8px;
         font-size: 16px;
         }
         .score {
         font-size: 42px;
         margin: 10px 0;
         font-weight: 800;
         color: #2d3436;
         }
         .score .red {
         color: #d63031;
         }
         .score .blue {
         color: #0984e3;
         }
         .score-small {
         font-size: 32px;
         font-weight: 700;
         margin: 5px 0;
         color: #2d3436;
         }
         .score-small .red {
         color: #d63031;
         }
         .score-small .blue {
         color: #0984e3;
         }
         .info-link {
         cursor: pointer;
         font-size: 12px;
         font-weight: 600;
         padding: 6px 12px;
         border-radius: 6px;
         background: #eff7ff;
         color: #0b66b8;
         border: 1px solid rgba(11, 102, 184, 0.24);
         transition: all 0.2s ease;
         min-height: 36px;
         }
         .info-link:hover {
         background: #0b66b8;
         color: white;
         transform: translateY(-1px);
         }
         .main-match-teams,
         .recent-match-teams {
         display: flex;
         justify-content: space-around;
         align-items: center;
         gap: 18px;
         }
         .team-col {
         text-align: center;
         }
         .team-name-red {
         color: #d63031;
         }
         .team-name-blue {
         color: #0984e3;
         }
         .team-name-small {
         font-size: 14px;
         }
         .form-team.red {
         color: #d63031;
         }
         .form-team.blue {
         color: #0984e3;
         }
         /* TABLES */
         .table-wrapper {
         overflow-x: auto;
         margin-top: 0;
         border-radius: 8px;
         }
         table {
         width: 100%;
         border-collapse: collapse;
         min-width: 600px;
         }
         /* Narrower table for scorers */
         .scorers-table-wrapper {
         overflow-x: auto;
         margin: 0 auto;
         border-radius: 8px;
         max-width: 600px;
         }
         .scorers-table-wrapper table {
         min-width: 400px;
         }
         /* Center align scorers table headers */
         .scorers-table-wrapper table th {
         text-align: center;
         }
         th {
         background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
         padding: 16px 12px;
         text-align: left;
         font-size: 12px;
         font-weight: 700;
         color: #636e72;
         text-transform: uppercase;
         letter-spacing: 0.5px;
         border-bottom: 2px solid #e0e0e0;
         cursor: pointer;
         user-select: none;
         white-space: nowrap;
         transition: background 0.2s ease;
         }
         th:hover {
         background: linear-gradient(135deg, #e9ecef 0%, #dee2e6 100%);
         }
         th.no-sort {
         cursor: default;
         }
         th.no-sort:hover {
         background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
         }
         th.sorted-asc::after {
         content: " ‚ñ≤";
         font-size: 11px;
         color: var(--brand);
         }
         th.sorted-desc::after {
         content: " ‚ñº";
         font-size: 11px;
         color: var(--brand);
         }
         td {
         padding: 16px 12px;
         border-bottom: 1px solid #f0f0f0;
         font-size: 14px;
         color: #2d3436;
         text-align: center;
         transition: background 0.2s ease;
         }
         tbody tr:nth-child(even) {
         background: #fafafa;
         }
         tbody tr:hover {
         background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
         }
         tr.highlight {
         background: linear-gradient(135deg, #fff9e6 0%, #fffbf0 100%) !important;
         }
         tr.highlight:hover {
         background: linear-gradient(135deg, #fff5d6 0%, #fff9e0 100%) !important;
         }
         /* SCORER COLORS */
         tr.team-crveni {
         background: #fff5f5 !important;
         }
         tr.team-plavi {
         background: #f5f9ff !important;
         }
         tr.team-crveni:hover {
         background: #ffebeb !important;
         }
         tr.team-plavi:hover {
         background: #ebf3ff !important;
         }
         tr.team-crveni td:first-child {
         color: #d63031;
         font-weight: bold;
         }
         tr.team-plavi td:first-child {
         color: #0984e3;
         font-weight: bold;
         }
         /* BADGES */
         .captain-badge {
         display: inline-block;
         background: linear-gradient(135deg, #ffd700, #ffed4e);
         color: #333;
         font-weight: bold;
         padding: 3px 7px;
         border-radius: 4px;
         margin-left: 6px;
         font-size: 10px;
         box-shadow: 0 2px 4px rgba(0,0,0,0.15);
         }
         .goalkeeper-badge {
         margin-left: 6px;
         font-size: 16px;
         }
         /* FORM */
         .form-box {
         margin-top: 0;
         text-align: center;
         font-size: 17px;
         display: flex;
         flex-direction: column;
         gap: 20px;
         }
         .form-row {
         display: flex;
         align-items: center;
         justify-content: center;
         gap: 12px;
         }
         .form-team {
         font-weight: 600;
         min-width: 80px;
         text-align: right;
         }
         .form-dots {
         display: flex;
         gap: 8px;
         }
         .dot {
         width: 20px;
         height: 20px;
         border-radius: 50%;
         display: inline-block;
         box-shadow: 0 2px 6px rgba(0,0,0,0.15);
         transition: all 0.2s ease;
         cursor: pointer;
         }
         .dot:hover {
         transform: scale(1.3);
         box-shadow: 0 3px 8px rgba(0,0,0,0.25);
         }
         .win {
         background: linear-gradient(135deg, #00b894, #00d2a0);
         }
         .loss {
         background: linear-gradient(135deg, #ff4757, #ff6b7a);
         }
         .draw {
         background: linear-gradient(135deg, #fdcb6e, #ffeaa7);
         }
         /* BUTTONS */
         .more-btn {
         width: 100%;
         padding: 16px;
         border: none;
         border-radius: 10px;
         font-size: 15px;
         font-weight: 700;
         cursor: pointer;
         transition: all 0.3s ease;
         margin-top: 25px;
         text-transform: uppercase;
         letter-spacing: 1px;
         background: linear-gradient(135deg, #0b66b8 0%, #0ea5a6 100%);
         color: white;
         box-shadow: 0 8px 20px rgba(11, 102, 184, 0.2);
         }
         .more-btn:hover {
         box-shadow: 0 10px 24px rgba(11, 102, 184, 0.24);
         transform: translateY(-2px);
         background: linear-gradient(135deg, #095ca8 0%, #0c9597 100%);
         }
         a:focus-visible,
         button:focus-visible,
         .info-link:focus-visible {
         outline: 3px solid var(--focus);
         outline-offset: 2px;
         }
         /* MODAL */
         #modalOverlay {
         display: none;
         position: fixed;
         inset: 0;
         background: rgba(0, 0, 0, 0.7);
         justify-content: center;
         align-items: center;
         backdrop-filter: blur(4px);
         z-index: 999;
         padding: 20px;
         animation: fadeIn 0.3s ease;
         }
         @keyframes fadeIn {
         from { opacity: 0; }
         to { opacity: 1; }
         }
         #modalBox {
         background: white;
         padding: 35px;
         border-radius: 16px;
         width: 90%;
         max-width: 600px;
         box-shadow: 0 24px 70px rgba(15, 23, 42, 0.28);
         border: 1px solid rgba(220, 231, 245, 0.95);
         animation: slideUp 0.3s ease;
         max-height: 90vh;
         overflow-y: auto;
         }
         @keyframes slideUp {
         from {
         transform: translateY(50px);
         opacity: 0;
         }
         to {
         transform: translateY(0);
         opacity: 1;
         }
         }
         #modalBox h2 {
         margin-top: 0;
         margin-bottom: 25px;
         color: #2d3436;
         text-align: left;
         font-size: 24px;
         }
         #closeModal {
         float: right;
         cursor: pointer;
         font-size: 28px;
         color: #999;
         line-height: 1;
         transition: all 0.3s ease;
         }
         #closeModal:hover {
         color: #333;
         transform: rotate(90deg);
         }
         #modalContent {
         margin-top: 8px;
         line-height: normal;
         white-space: normal;
         text-align: left;
         }
         .scorer-item {
         display: flex;
         align-items: center;
         justify-content: space-between;
         padding: 5px 8px;     /* +1px vertikalno */
         margin: 2px 0;       /* +1px izmeƒëu redova */
         font-size: 13px;
         font-weight: 500;
         line-height: 1.15;   /* mrvicu rastereƒáenje */
         border-radius: 4px;
         }
         .scorer-item:hover {
         background-color: rgba(0,0,0,0.02);
         }
         .scorer-item.red {
         background: #fff5f5;
         color: #d63031;
         border-left: 2px solid #d63031;
         }
         .scorer-item.blue {
         background: #f5f9ff;
         color: #0984e3;
         border-left: 2px solid #0984e3;
         }
         /* MOBILE RESPONSIVE */
         @media (max-width: 768px) {
         body {
         padding: 15px 10px;
         }
         .container {
         max-width: 100%;
         }
         header {
         padding: 20px 25px;
         border-radius: 12px;
         margin-bottom: 25px;
         }
         .logo {
         font-size: 26px;
         margin-bottom: 15px;
         }
         .header-nav {
         gap: 10px;
         }
         .team-link {
         flex: 1;
         min-width: 110px;
         justify-content: center;
         font-size: 13px;
         padding: 10px 14px;
         }
         .main-match-teams .team-logo {
         width: 120px;
         height: 120px;
         }
         #loginBtn {
         width: 100%;
         text-align: center;
         padding: 12px;
         }
         .card {
         border-radius: 12px;
         margin-bottom: 25px;
         }
         .card-header {
         padding: 20px 25px 16px;
         }
         .card-content {
         padding: 25px;
         }
         h1, h2 {
         font-size: 20px;
         }
         .match-box {
         padding: 20px;
         }
         .recent-matches-content .match-box {
         padding: 18px 0;
         }
         .match-info {
         margin-bottom: 15px;
         }
         .match-links {
         gap: 6px;
         margin-top: 10px;
         }
         .info-link {
         font-size: 11px;
         padding: 5px 12px;
         }
         .team-logo {
         width: 90px;
         height:90px;
         }
         .team-name {
         font-size: 13px;
         margin-top: 6px;
         }
         .score {
         font-size: 30px;
         }
         .score-small {
         font-size: 22px;
         }
         /* Hide less important columns on mobile for league table */
         /* Sakrij sekundarne kolone */
         .table-wrapper table th:nth-child(2),
         .table-wrapper table td:nth-child(2), /* Utakmice */
         .table-wrapper table th:nth-child(4),
         .table-wrapper table td:nth-child(4), /* Nere≈°eno */
         .table-wrapper table th:nth-child(6),
         .table-wrapper table td:nth-child(6), /* Dati */
         .table-wrapper table th:nth-child(7),
         .table-wrapper table td:nth-child(7) { /* Primljeni */
         display: none;
         }
         table {
         min-width: 380px;
         }
         .scorers-table-wrapper table {
         min-width: 350px;
         }
         th, td {
         padding: 10px 6px;
         font-size: 11px;
         }
         th {
         padding: 12px 8px;
         }
         .form-box {
         font-size: 15px;
         gap: 15px;
         }
         .form-team {
         min-width: 70px;
         font-size: 15px;
         }
         .form-dots {
         gap: 6px;
         }
         .dot {
         width: 18px;
         height: 18px;
         }
         .more-btn {
         padding: 14px;
         margin-top: 20px;
         font-size: 14px;
         }
         #modalBox {
         padding: 25px;
         width: 95%;
         }
         #modalBox h2 {
         margin-bottom: 20px;
         font-size: 20px;
         }
         #closeModal {
         font-size: 24px;
         }
         .scorer-item {
         font-size: 14px;
         padding: 10px 14px;
         }
         }
         @media (max-width: 480px) {
         body {
         padding: 12px 8px;
         }
         header {
         padding: 18px 20px;
         }
         .logo {
         font-size: 24px;
         }
         .card {
         border-radius: 12px;
         margin-bottom: 20px;
         }
         .card-header {
         padding: 18px 20px 14px;
         }
         .card-content {
         padding: 20px;
         }
         h1, h2 {
         font-size: 18px;
         }
         .match-box {
         padding: 16px;
         }
         .recent-matches-content .match-box {
         padding: 15px 0;
         }
         .team-logo {
         width: 50px;
         height: 50px;
         }
         .score {
         font-size: 26px;
         }
         table {
         min-width: 400px;
         }
         .scorers-table-wrapper table {
         min-width: 320px;
         }
         th, td {
         padding: 8px 4px;
         font-size: 10px;
         }
         th {
         padding: 10px 6px;
         }
         .captain-badge {
         font-size: 8px;
         padding: 2px 5px;
         }
         .goalkeeper-badge {
         font-size: 14px;
         }
         .form-box {
         font-size: 14px;
         gap: 12px;
         }
         .form-team {
         min-width: 60px;
         font-size: 14px;
         }
         .dot {
         width: 16px;
         height: 16px;
         }
         .main-match-teams,
         .recent-match-teams {
         gap: 10px;
         }
         }
         @media (max-width: 640px) {
         .main-match-teams,
         .recent-match-teams {
         flex-wrap: nowrap;
         justify-content: space-between;
         }
         .main-match-teams .score,
         .recent-match-teams .score-small {
         width: auto;
         text-align: center;
         min-width: 76px;
         }
         .main-match-teams .team-col,
         .recent-match-teams .team-col {
         flex: 1;
         min-width: 0;
         }
         .main-match-teams .team-logo,
         .recent-match-teams .team-logo {
         width: clamp(62px, 24vw, 110px) !important;
         height: clamp(62px, 24vw, 110px) !important;
         }
         }
         @media (max-width: 360px) {
         .main-match-teams,
         .recent-match-teams {
         gap: 4px;
         }
         .main-match-teams .team-logo,
         .recent-match-teams .team-logo {
         width: 58px !important;
         height: 58px !important;
         }
         .main-match-teams .team-name,
         .recent-match-teams .team-name {
         font-size: 12px;
         margin-top: 4px;
         }
         .main-match-teams .score {
         font-size: 22px;
         min-width: 62px;
         }
         .recent-match-teams .score-small {
         font-size: 19px;
         min-width: 62px;
         }
         .match-box {
         padding: 12px;
         }
         .match-info {
         margin-bottom: 10px;
         font-size: 12px;
         }
         .match-links {
         gap: 4px;
         }
         .info-link {
         font-size: 10px;
         padding: 4px 8px;
         min-height: 30px;
         }
         }
         /* === UNIFIED SECTION SPACING === */
         header {
         margin-bottom: 28px;
         }
         .card {
         margin-bottom: 28px;
         }
         @media (max-width: 768px) {
         header {
         margin-bottom: 22px;
         }
         .card {
         margin-bottom: 22px;
         }
         }
         @media (max-width: 480px) {
         header {
         margin-bottom: 18px;
         }
         .card {
         margin-bottom: 18px;
         }
         }
         @media (prefers-reduced-motion: reduce) {
         * {
         animation: none !important;
         transition: none !important;
         scroll-behavior: auto !important;
         }
         }
         @keyframes riseIn {
         from { opacity: 0; transform: translateY(12px); }
         to { opacity: 1; transform: translateY(0); }
         }
      </style>
   </head>
   <body>
      <div class="container">
         <!-- HEADER -->
         <header>
            <div class="logo">Fudbalski Rezultati</div>
            <div class="hero-subtitle">
               Pregled rezultata, strelaca i sastava po utakmicama
            </div>
            <div class="header-nav">
               <a href="crveni.html" class="team-link red">üî¥ Vidi ekipu ‚Äì Crveni</a>
               <a href="plavi.html" class="team-link blue">üîµ Vidi ekipu ‚Äì Plavi</a>
            </div>
         </header>
         <!-- MAIN MATCH -->
         <div class="card">
            <h1 class="card-header">Rezultat poslednjeg kola</h1>
            <div class="card-content">
               <div id="mainMatch"></div>
            </div>
         </div>
         <!-- TABELA -->
         <div class="card">
            <h2 class="card-header">Tabela</h2>
            <div class="card-content">
               <div class="table-wrapper">
                  <table>
                     <thead>
                        <tr>
                           <th class="no-sort">Tim</th>
                           <th data-sort="U" data-table="league">Utakmice</th>
                           <th data-sort="P" data-table="league">Pobede</th>
                           <th data-sort="N" data-table="league">Nere≈°eno</th>
                           <th data-sort="I" data-table="league">Porazi</th>
                           <th data-sort="GD" data-table="league">Dati</th>
                           <th data-sort="GP" data-table="league">Primljeni</th>
                           <th data-sort="GR" data-table="league">Razlika</th>
                           <th data-sort="B" data-table="league">Bodovi</th>
                        </tr>
                     </thead>
                     <tbody id="leagueBody"></tbody>
                  </table>
               </div>
            </div>
         </div>
         <!-- LISTA STRELACA -->
         <div class="card">
            <h2 class="card-header">Lista strelaca</h2>
            <div class="card-content">
               <div class="scorers-table-wrapper">
                  <table>
                     <thead>
                        <tr>
                           <th data-sort="name" data-table="scorers">Ime</th>
                           <th data-sort="team" data-table="scorers">Tim</th>
                           <th data-sort="goals" data-table="scorers">Golovi</th>
                        </tr>
                     </thead>
                     <tbody id="scorersBody"></tbody>
                  </table>
               </div>
            </div>
         </div>
         <!-- FORMA -->
         <div class="card">
            <h2 class="card-header">Forma poslednjih 5 meƒçeva</h2>
            <div class="card-content">
               <div class="form-box" id="formBox"></div>
            </div>
         </div>
         <!-- RECENT MATCHES -->
         <div id="recentMatches"></div>
      </div>
      <!-- MODAL -->
      <div id="modalOverlay">
         <div id="modalBox">
            <span id="closeModal">‚úï</span>
            <h2 id="modalTitle">Info o meƒçu</h2>
            <div id="modalContent"></div>
         </div>
      </div>
      <script type="module">
         import { onValue } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-database.js";
         
         let allMatches = [];
         let allPlayers = { crveni: {}, plavi: {} };
         let tableData = {};
         let scorersData = [];
         let currentSort = {
           league: { field: 'B', dir: 'desc' },
           scorers: { field: 'goals', dir: 'desc' }
         };
                  
         function escapeHtml(value) {
           return String(value ?? "").replace(/[&<>"']/g, char => ({
             "&": "&amp;",
             "<": "&lt;",
             ">": "&gt;",
             '"': "&quot;",
             "'": "&#39;"
           }[char]));
         }
         
         /* -------- FORMAT PLAYER NAME -------- */
         function formatPlayerName(name) {
           if (!name) return '';
         
           let displayName = name;
           let badges = '';
         
           const captainRegex = /\s*\(c\)\s*/i;
           if (captainRegex.test(name)) {
             displayName = name.replace(captainRegex, ' ').trim();
             badges += '<span class="captain-badge">C</span>';
           }
         
           const goalkeeperRegex = /\s*\(g\)\s*/i;
           if (goalkeeperRegex.test(name)) {
             displayName = name.replace(goalkeeperRegex, ' ').trim();
             badges += '<span class="goalkeeper-badge">üß§</span>';
           }
         
           return escapeHtml(displayName) + badges;
         }
         
         /* LOAD MATCHES */
         onValue(window.dbRef("matches"), snap => {
           const data = snap.val() || {};
           allMatches = Object.values(data).sort((a,b)=>b.timestamp - a.timestamp);
         
           renderMainAndRecent(allMatches);
           calculateTable(allMatches);
           renderTable();
           renderForm(allMatches);
         });
         
         /* LOAD PLAYERS FOR SCORERS */
         onValue(window.dbRef("players"), snap => {
           const players = snap.val() || {};
           allPlayers = players || { crveni: {}, plavi: {} };
           scorersData = [];
         
           ['crveni', 'plavi'].forEach(team => {
             if (players[team]) {
               Object.entries(players[team]).forEach(([id, player]) => {
                 const goals = Number(player.goals) || 0;
                 if (goals >= 1) {
                   scorersData.push({
                     name: player.name || '',
                     team: team === 'crveni' ? 'Crveni' : 'Plavi',
                     teamKey: team,
                     goals: goals
                   });
                 }
               });
             }
           });
         
           renderScorers();
         });
         
         /* -------- MAIN MATCH + RECENT (DOLE) -------- */
         function renderMainAndRecent(matches) {
           const mainBox = document.getElementById("mainMatch");
           const recentBox = document.getElementById("recentMatches");
         
           mainBox.innerHTML = "";
           recentBox.innerHTML = "";
         
           if (!matches.length) return;
         
           const latest = matches[0];
         
           const matchLinks = `
         ${latest.info ? `<button type="button" class="info-link" onclick="openMatchInfo(0)">‚ÑπÔ∏è Info</button>` : ""}
         <button type="button" class="info-link" onclick="openMatchScorers(0)">‚öΩ Strelci</button>
         <button type="button" class="info-link" onclick="openMatchLineup(0)">üßç Sastavi</button>
         `;
         
         
           mainBox.innerHTML = `
             <div class="match-box">
               <div class="match-info">
                 Kolo ${escapeHtml(latest.round)} ‚Äî ${escapeHtml(latest.date)} u ${escapeHtml(latest.time)}
                 <div class="match-links">${matchLinks}</div>
               </div>
         
               <div class="main-match-teams">
                 
                 <div class="team-col">
                   <img src="crveni.png" class="team-logo" alt="Crveni" loading="lazy" decoding="async">
                   <div class="team-name team-name-red">Crveni</div>
                 </div>
         
                 <div class="score">
         <span class="red">${escapeHtml(latest.red)}</span> -
         <span class="blue">${escapeHtml(latest.blue)}</span>
         </div>
         
         
                 <div class="team-col">
                   <img src="plavi.png" class="team-logo" alt="Plavi" loading="lazy" decoding="async">
                   <div class="team-name team-name-blue">Plavi</div>
                 </div>
         
               </div>
             </div>
           `;
         
           const recent = matches.slice(1,4);
         
           if (recent.length) {
             let matchesHTML = '';
         
             recent.forEach((m, idx) => {
               const matchIndex = idx + 1;
               const recentMatchLinks = `
         ${m.info ? `<button type="button" class="info-link" onclick="openMatchInfo(${matchIndex})">‚ÑπÔ∏è Info</button>` : ""}
         <button type="button" class="info-link" onclick="openMatchScorers(${matchIndex})">‚öΩ Strelci</button>
         <button type="button" class="info-link" onclick="openMatchLineup(${matchIndex})">üßç Sastavi</button>
         `;
         
         
               matchesHTML += `
                 <div class="match-box">
                   <div class="match-info">
                     Kolo ${escapeHtml(m.round)} ‚Äî ${escapeHtml(m.date)} u ${escapeHtml(m.time)}
                     <div class="match-links">${recentMatchLinks}</div>
                   </div>
         
                   <div class="recent-match-teams">
         
                     <div class="team-col">
                       <img src="crveni.png" class="team-logo" style="width:140px; height:140px;" alt="Crveni" loading="lazy" decoding="async">
                       <div class="team-name team-name-red team-name-small">Crveni</div>
                     </div>
         
                    <div class="score-small">
         <span class="red">${escapeHtml(m.red)}</span> -
         <span class="blue">${escapeHtml(m.blue)}</span>
         </div>
         
                     <div class="team-col">
                       <img src="plavi.png" class="team-logo" style="width:140px; height:140px;" alt="Plavi" loading="lazy" decoding="async">
                       <div class="team-name team-name-blue team-name-small">Plavi</div>
                     </div>
         
                   </div>
                 </div>
               `;
             });
         
             recentBox.innerHTML = `
               <div class="card">
                 <h2 class="card-header">Rezultati pro≈°lih kola</h2>
                 <div class="card-content recent-matches-content">
                   ${matchesHTML}
                   <button class="more-btn" onclick="window.location='istorija.html'">
                     Vidi sve utakmice ‚Üí
                   </button>
                 </div>
               </div>
             `;
           }
         }
         
         /* -------- CALCULATE TABLE DATA -------- */
         function calculateTable(matches) {
           tableData = {
             Crveni: { Tim: 'Crveni', U:0,P:0,N:0,I:0,GD:0,GP:0,GR:0,B:0 },
             Plavi:  { Tim: 'Plavi', U:0,P:0,N:0,I:0,GD:0,GP:0,GR:0,B:0 }
           };
         
           matches.forEach(m=>{
             tableData.Crveni.U++; tableData.Plavi.U++;
         
             tableData.Crveni.GD += m.red;
             tableData.Crveni.GP += m.blue;
         
             tableData.Plavi.GD += m.blue;
             tableData.Plavi.GP += m.red;
         
             if (m.red > m.blue) {
               tableData.Crveni.P++; tableData.Crveni.B += 3; tableData.Plavi.I++;
             } else if (m.blue > m.red) {
               tableData.Plavi.P++; tableData.Plavi.B += 3; tableData.Crveni.I++;
             } else {
               tableData.Crveni.N++; tableData.Plavi.N++;
               tableData.Crveni.B++; tableData.Plavi.B++;
             }
           });
         
           tableData.Crveni.GR = tableData.Crveni.GD - tableData.Crveni.GP;
           tableData.Plavi.GR  = tableData.Plavi.GD - tableData.Plavi.GP;
         }
         
         /* -------- RENDER TABLE WITH SORTING -------- */
         function renderTable() {
           const teams = Object.values(tableData);
           const { field, dir } = currentSort.league;
         
           teams.sort((a, b) => {
         // 1. Bodovi (uvek primarno)
         if (b.B !== a.B) {
         return b.B - a.B;
         }
         
         // 2. Gol razlika (sekundarno)
         if (b.GR !== a.GR) {
         return b.GR - a.GR;
         }
         
         // 3. Tek onda aktivni sort (ako klikne≈° kolonu)
         const valA = a[field];
         const valB = b[field];
         
         if (typeof valA === "number" && typeof valB === "number") {
         return dir === 'asc' ? valA - valB : valB - valA;
         }
         
         return 0;
         });
         
         
           const tbody = document.getElementById("leagueBody");
           tbody.innerHTML = "";
         
           teams.forEach((team, index) => {
             const highlightClass = index === 0 ? 'class="highlight"' : '';
             tbody.innerHTML += `
               <tr ${highlightClass}>
                 <td>${team.Tim}</td>
                 <td>${team.U}</td>
                 <td>${team.P}</td>
                 <td>${team.N}</td>
                 <td>${team.I}</td>
                 <td>${team.GD}</td>
                 <td>${team.GP}</td>
                 <td>${team.GR}</td>
                 <td><strong>${team.B}</strong></td>
               </tr>
             `;
           });
         
           updateSortIndicators('league');
         }
         
         /* -------- RENDER SCORERS TABLE -------- */
         function renderScorers() {
           const scorers = [...scorersData];
           const { field, dir } = currentSort.scorers;
         
           scorers.sort((a, b) => {
             if (field === 'name') {
               const nameA = a.name.replace(/\s*\(c\)\s*/gi, '').replace(/\s*\(g\)\s*/gi, '').trim().toLowerCase();
               const nameB = b.name.replace(/\s*\(c\)\s*/gi, '').replace(/\s*\(g\)\s*/gi, '').trim().toLowerCase();
               return dir === 'asc'
                 ? nameA.localeCompare(nameB, 'sr')
                 : nameB.localeCompare(nameA, 'sr');
             } else if (field === 'team') {
               if (a.team === b.team) {
                 return b.goals - a.goals;
               }
               return dir === 'asc'
                 ? a.team.localeCompare(b.team, 'sr')
                 : b.team.localeCompare(a.team, 'sr');
             } else {
               if (a.goals === b.goals) {
                 const nameA = a.name.replace(/\s*\(c\)\s*/gi, '').replace(/\s*\(g\)\s*/gi, '').trim();
                 const nameB = b.name.replace(/\s*\(c\)\s*/gi, '').replace(/\s*\(g\)\s*/gi, '').trim();
                 return nameA.localeCompare(nameB, 'sr');
               }
               return dir === 'asc' ? a.goals - b.goals : b.goals - a.goals;
             }
           });
         
           const tbody = document.getElementById("scorersBody");
           tbody.innerHTML = "";
         
           scorers.forEach(player => {
             tbody.innerHTML += `
               <tr class="team-${player.teamKey}">
                 <td>${formatPlayerName(player.name)}</td>
                 <td>${player.team}</td>
                 <td><strong>${player.goals}</strong></td>
               </tr>
             `;
           });
         
           updateSortIndicators('scorers');
         }
         
         /* -------- UPDATE SORT INDICATORS -------- */
         function updateSortIndicators(table) {
           const { field, dir } = currentSort[table];
         
           document.querySelectorAll(`th[data-table="${table}"]`).forEach(th => {
             th.classList.remove('sorted-asc', 'sorted-desc');
             if (th.dataset.sort === field) {
               th.classList.add(dir === 'asc' ? 'sorted-asc' : 'sorted-desc');
             }
           });
         }
         
         /* -------- SORT CLICK HANDLERS -------- */
         document.addEventListener("DOMContentLoaded", () => {
           document.querySelectorAll("th[data-sort]").forEach(th => {
             th.addEventListener("click", () => {
               const field = th.dataset.sort;
               const table = th.dataset.table;
         
               if (currentSort[table].field === field) {
                 currentSort[table].dir = currentSort[table].dir === 'asc' ? 'desc' : 'asc';
               } else {
                 currentSort[table].field = field;
                 currentSort[table].dir = field === 'name' ? 'asc' : 'desc';
               }
         
               if (table === 'league') {
                 renderTable();
               } else if (table === 'scorers') {
                 renderScorers();
               }
             });
           });
         });
         
         /* -------- FORMA -------- */
         function renderForm(matches) {
           const last5 = matches.slice(0,5);
         
           let crDots = "", plDots = "";
         
           last5.forEach(m=>{
             crDots += (m.red > m.blue) ? `<span class="dot win" title="Pobeda"></span>` :
                       (m.red < m.blue) ? `<span class="dot loss" title="Poraz"></span>` :
                                          `<span class="dot draw" title="Nere≈°eno"></span>`;
         
             plDots += (m.blue > m.red) ? `<span class="dot win" title="Pobeda"></span>` :
                       (m.blue < m.red) ? `<span class="dot loss" title="Poraz"></span>` :
                                          `<span class="dot draw" title="Nere≈°eno"></span>`;
           });
         
           document.getElementById("formBox").innerHTML = `
             <div class="form-row">
               <div class="form-team red">Crveni</div>
               <div class="form-dots">${crDots}</div>
             </div>
             <div class="form-row">
               <div class="form-team blue">Plavi</div>
               <div class="form-dots">${plDots}</div>
             </div>
           `;
         }
         
         /* -------- MODAL - INFO -------- */
         window.openMatchInfo = idx => {
         const match = allMatches[idx];
         if (!match) return;
         
         document.getElementById("modalTitle").innerText = "‚ÑπÔ∏è Info o meƒçu";
         const content = document.getElementById("modalContent");
         content.innerHTML = "";
         const info = document.createElement("div");
         info.style.whiteSpace = "pre-line";
         info.textContent = match.info || "Nema dodatnih informacija";
         content.appendChild(info);
         
         document.getElementById("modalOverlay").style.display = "flex";
         };
         
         
         /* -------- MODAL - SCORERS -------- */
         window.openMatchScorers = idx => {
           const match = allMatches[idx];
           if (!match) return;
              
           const scorers = match.scorers || [];
         
           document.getElementById("modalTitle").innerText = "Strelci na meƒçu";
         
           if (scorers.length === 0) {
             document.getElementById("modalContent").innerHTML = '<p style="text-align:center; padding:20px; color:#999;">Nema strelaca za ovaj meƒç</p>';
           } else {
         const grouped = {};
         
         scorers.forEach(s => {
         if (s.type === "own_goal") {
         grouped["__own_goal__"] = (grouped["__own_goal__"] || 0) + 1;
         } else {
         const key = `${s.team}:${s.id}`;
         grouped[key] = (grouped[key] || 0) + 1;
         }
         });
         
         let html = "";
         
         Object.entries(grouped)
         .map(([key, count]) => {
         let name = "";
         let teamClass = "";
         
         if (key === "__own_goal__") {
         name = "Autogol (OG)";
         teamClass = "red";
         } else {
         const [team, id] = key.split(":");
         name = allPlayers[team]?.[id]?.name || "(nepoznat)";
         teamClass = team === "crveni" ? "red" : "blue";
         }
         
         return {
         name: name.replace(/\s*\(c\)|\s*\(g\)/gi, "").trim(),
         displayName: name,
         teamClass,
         count
         };
         })
         .sort((a, b) => {
         if (b.count !== a.count) {
         return b.count - a.count; // vi≈°e golova prvo
         }
         return a.name.localeCompare(b.name, "sr"); // ime A‚ÄìZ
         })
         .forEach(item => {
         html += `
         <div class="scorer-item ${item.teamClass}">
         ${formatPlayerName(item.displayName)}
         <span style="font-weight:600;font-size:12px;white-space:nowrap;">
          ‚öΩ √ó${item.count}
         </span>
         </div>
         `;
         });
         
         
         document.getElementById("modalContent").innerHTML = html;
         document.getElementById("modalOverlay").style.display = "flex";  
         }
         };
         
         window.openMatchLineup = idx => {
         const match = allMatches[idx];
         if (!match) return;
         
         document.getElementById("modalTitle").innerText = "üßç Sastavi";
         
         renderMatchLineup(match);
         document.getElementById("modalOverlay").style.display = "flex";
         };
         
         
         
         function renderMatchLineup(match) {
         const redPlayers = Object.entries(match.played || {})
         .filter(([_, team]) => team === "crveni")
         .map(([id]) => allPlayers.crveni?.[id]?.name || "(nepoznat)");
         
         const bluePlayers = Object.entries(match.played || {})
         .filter(([_, team]) => team === "plavi")
         .map(([id]) => allPlayers.plavi?.[id]?.name || "(nepoznat)");
         
         const renderTeam = (title, players, color) => `
         <div style="margin-bottom:20px;">
         <h3 style="margin-bottom:10px;color:${color};">${title}</h3>
         ${players.length
         ? players.map(p => `
            <div class="scorer-item ${color === '#d63031' ? 'red' : 'blue'}">
              ${formatPlayerName(p)}
            </div>
          `).join("")
         : `<p style="color:#999;">Nema podataka</p>`
         }
         </div>
         `;
         
         document.getElementById("modalContent").innerHTML = `
         ${renderTeam("üî¥ Crveni", redPlayers, "#d63031")}
         ${renderTeam("üîµ Plavi", bluePlayers, "#0984e3")}
         `;
         }
         
         document.getElementById("closeModal").addEventListener("click", () => {
         document.getElementById("modalOverlay").style.display = "none";
         });
         
         document.getElementById("modalOverlay").addEventListener("click", (e) => {
         if (e.target.id === "modalOverlay") {
         e.target.style.display = "none";
         }
         });
         
      </script>
   </body>
</html>
