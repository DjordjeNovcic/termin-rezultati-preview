<!DOCTYPE html>
<html lang="sr">
   <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Ekipa Plavih</title>
      <script type="module" src="firebase.mjs"></script>
      <style>
         @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap');
         * {
         box-sizing: border-box;
         margin: 0;
         padding: 0;
         }
         body {
         font-family: 'Plus Jakarta Sans', 'Avenir Next', 'Segoe UI', sans-serif;
         background: linear-gradient(180deg, #f5f7fb 0%, #eef1f7 100%);
         min-height: 100vh;
         padding: 16px 12px;
         }
         .container {
         max-width: 900px;
         margin: 0 auto;
         }
         /* CARD */
         .card {
         background: white;
         border-radius: 16px;
         padding: 0;
         margin-bottom: 30px;
         box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
         overflow: hidden;
         transition: transform 0.3s ease, box-shadow 0.3s ease;
         animation: fadeIn 0.5s ease;
         }
         .card:hover {
         transform: translateY(-4px);
         box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
         }
         @keyframes fadeIn {
         from { opacity: 0; transform: translateY(20px); }
         to { opacity: 1; transform: translateY(0); }
         }
         /* Section header with gradient */
         .card-header {
         padding: 25px 35px 20px;
         background: linear-gradient(135deg, #0984e3 0%, #00b894 100%);
         color: white;
         margin: 0;
         }
         #imageOverlay {
         position: fixed;
         inset: 0;
         background: rgba(0, 0, 0, 0.85);
         display: none;
         align-items: center;
         justify-content: center;
         z-index: 1000;
         cursor: zoom-out;
         }
         #imageOverlay img {
         max-width: 90%;
         max-height: 90%;
         border-radius: 12px;
         box-shadow: 0 20px 60px rgba(0,0,0,0.4);
         }
         .overlay-close {
         position: absolute;
         top: 16px;
         right: 16px;
         width: 38px;
         height: 38px;
         border-radius: 999px;
         border: 1px solid rgba(255, 255, 255, 0.45);
         background: rgba(15, 23, 42, 0.55);
         color: #fff;
         font-size: 22px;
         line-height: 1;
         display: inline-flex;
         align-items: center;
         justify-content: center;
         cursor: pointer;
         transition: all 0.2s ease;
         z-index: 5;
         }
         .overlay-close:hover {
         background: rgba(15, 23, 42, 0.75);
         transform: rotate(90deg);
         }
         .card-content {
         padding: 30px 35px 35px;
         }
         h1 {
         font-size: 28px;
         font-weight: 700;
         margin: 0;
         text-align: center;
         }
         /* Team Image */
         .team-image-wrapper {
         display: flex;
         justify-content: center;
         margin-bottom: 30px;
         }
         .team-image {
         width: 70%;
         max-width: 400px;
         border-radius: 12px;
         box-shadow: 0 8px 24px rgba(9, 132, 227, 0.2);
         transition: transform 0.3s ease, box-shadow 0.3s ease;
         }
         .team-image:hover {
         transform: scale(1.05);
         box-shadow: 0 12px 32px rgba(9, 132, 227, 0.3);
         }
         /* TABLE */
         .table-wrapper {
         overflow-x: auto;
         border-radius: 8px;
         }
         table {
         width: 100%;
         border-collapse: collapse;
         min-width: 500px;
         }
         th, td {
         padding: 16px 12px;
         text-align: left;
         border-bottom: 1px solid #f0f0f0;
         }
         th {
         background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
         color: #636e72;
         font-weight: 700;
         font-size: 12px;
         text-transform: uppercase;
         letter-spacing: 0.5px;
         cursor: pointer;
         user-select: none;
         white-space: nowrap;
         transition: background 0.2s ease;
         border-bottom: 2px solid #e0e0e0;
         }
         th:hover {
         background: linear-gradient(135deg, #e9ecef 0%, #dee2e6 100%);
         }
         th.sorted-asc::after {
         content: " ‚ñ≤";
         font-size: 11px;
         color: #0984e3;
         margin-left: 6px;
         }
         th.sorted-desc::after {
         content: " ‚ñº";
         font-size: 11px;
         color: #0984e3;
         margin-left: 6px;
         }
         td {
         font-size: 14px;
         color: #2d3436;
         transition: background 0.2s ease;
         }
         tbody tr:nth-child(even) {
         background: #f5f9ff;
         }
         tbody tr:hover {
         background: linear-gradient(135deg, rgba(9, 132, 227, 0.08) 0%, rgba(0, 184, 148, 0.08) 100%);
         }
         td:nth-child(2),
         td:nth-child(3),
         th:nth-child(2),
         th:nth-child(3) {
         text-align: center;
         }
         /* Captain and Goalkeeper badges */
         .captain-badge {
         display: inline-block;
         background: linear-gradient(135deg, #ffd700, #ffed4e);
         color: #333;
         font-weight: bold;
         padding: 3px 7px;
         border-radius: 4px;
         margin-left: 8px;
         font-size: 10px;
         box-shadow: 0 2px 4px rgba(0,0,0,0.15);
         }
         .goalkeeper-badge {
         margin-left: 8px;
         font-size: 16px;
         }
         /* MOBILE STYLES */
         @media (max-width: 768px) {
         body {
         padding: 15px 10px;
         }
         .card {
         margin-bottom: 25px;
         }
         .card-header {
         padding: 20px 25px 16px;
         }
         .card-content {
         padding: 25px;
         }
         h1 {
         font-size: 22px;
         }
         .team-image {
         width: 80%;
         max-width: 300px;
         }
         .team-image-wrapper {
         margin-bottom: 25px;
         }
         table {
         min-width: 400px;
         }
         th, td {
         padding: 12px 8px;
         font-size: 13px;
         }
         th {
         font-size: 11px;
         padding: 14px 10px;
         }
         .captain-badge {
         font-size: 9px;
         padding: 2px 5px;
         margin-left: 6px;
         }
         .goalkeeper-badge {
         font-size: 14px;
         margin-left: 6px;
         }
         }
         @media (max-width: 480px) {
         body {
         padding: 12px 8px;
         }
         .card-header {
         padding: 18px 20px 14px;
         }
         .card-content {
         padding: 20px;
         }
         h1 {
         font-size: 20px;
         }
         .team-image {
         width: 90%;
         }
         .team-image-wrapper {
         margin-bottom: 20px;
         }
         table {
         min-width: 400px;
         }
         th, td {
         padding: 10px 6px;
         font-size: 11px;
         }
         th {
         font-size: 10px;
         padding: 12px 8px;
         }
         th.sorted-asc::after,
         th.sorted-desc::after {
         font-size: 9px;
         margin-left: 3px;
         }
         .captain-badge {
         font-size: 8px;
         padding: 1px 4px;
         margin-left: 4px;
         }
         .goalkeeper-badge {
         font-size: 13px;
         }
         }
         /* === UNIFIED SECTION SPACING === */
         .card {
         margin-bottom: 28px;
         }
         @media (max-width: 768px) {
         .card {
         margin-bottom: 22px;
         }
         }
         @media (max-width: 480px) {
         .card {
         margin-bottom: 18px;
         }
         }
         /* === TEAM PAGE HEADER (PLAVI) === */
         .team-header {
         display: flex;
         align-items: center;
         gap: 16px;
         }
         .back-link-inline {
         font-size: 13px;
         font-weight: 600;
         color: #fff;
         text-decoration: none;
         opacity: 0.85;
         padding: 6px 10px;
         border-radius: 6px;
         background: rgba(255,255,255,0.15);
         transition: all 0.2s ease;
         }
         .back-link-inline:hover {
         opacity: 1;
         background: rgba(255,255,255,0.25);
         }
         .image-zoom-hint {
         position: relative;
         width: 100%;
         display: flex;
         justify-content: center;
         }
         .zoom-hint {
         position: absolute;
         bottom: 12px;
         right: 12px;
         background: rgba(0, 0, 0, 0.65);
         color: #fff;
         font-size: 11px;
         font-weight: 600;
         padding: 6px 10px;
         border-radius: 16px;
         opacity: 0;
         pointer-events: none;
         transition: opacity 0.25s ease, transform 0.25s ease;
         transform: translateY(4px);
         }
         /* Desktop hover */
         .image-zoom-hint:hover .zoom-hint {
         opacity: 1;
         transform: translateY(0);
         }
         /* Mobile ‚Äì hint uvek blago vidljiv */
         @media (hover: none) {
         .zoom-hint {
         opacity: 0.85;
         transform: translateY(0);
         }
         }
         @media (max-width: 640px) {
         .table-wrapper table,
         .table-wrapper thead,
         .table-wrapper tbody,
         .table-wrapper tr,
         .table-wrapper th,
         .table-wrapper td {
         display: block;
         width: 100%;
         }
         .table-wrapper thead {
         display: none;
         }
         .table-wrapper tr {
         border: 1px solid #e7eef8;
         border-radius: 12px;
         padding: 10px;
         margin-bottom: 10px;
         background: #fff;
         }
         .table-wrapper td {
         border: none;
         padding: 6px 4px;
         text-align: left;
         }
         .table-wrapper td[data-label]::before {
         content: attr(data-label) ": ";
         font-weight: 700;
         color: #475569;
         }
         }
         a:focus-visible,
         button:focus-visible,
         th:focus-visible {
         outline: 3px solid #0b66b8;
         outline-offset: 2px;
         }
         @media (prefers-reduced-motion: reduce) {
         * {
         animation: none !important;
         transition: none !important;
         scroll-behavior: auto !important;
         }
         }
      </style>
   </head>
   <body>
      <div class="container">
         <!-- TEAM CARD -->
         <div class="card">
            <div class="card-header team-header">
               <a href="index.html" class="back-link-inline">‚Üê Nazad</a>
               <span>Igraƒçi ‚Äì Plavi</span>
            </div>
            <div class="card-content">
               <div class="team-image-wrapper image-zoom-hint">
                  <img src="plavi-team.png" class="team-image" alt="Ekipa Plavih" loading="lazy" decoding="async">
                  <span class="zoom-hint">Tap to zoom</span>
               </div>
               <div class="table-wrapper">
                  <table>
                     <thead>
                        <tr>
                           <th data-sort="name">Igraƒç</th>
                           <th data-sort="matches">Utakmice</th>
                           <th data-sort="goals">Golovi</th>
                        </tr>
                     </thead>
                     <tbody id="teamTable"></tbody>
                  </table>
               </div>
            </div>
         </div>
      </div>
      <div id="imageOverlay">
         <button type="button" class="overlay-close" aria-label="Zatvori pregled">‚úï</button>
         <img id="imagePreview" alt="Team preview">
      </div>
      <script type="module">
         import { onValue } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-database.js";
         
         let currentSort = { field: "goals", dir: "desc" };
         let playersData = {};
         
         /* ---------------- FORMAT PLAYER NAME ---------------- */
         function formatPlayerName(name) {
           if (!name) return '';
         
           let displayName = name;
           let badges = '';
         
           const captainRegex = /\s*\(c\)\s*/i;
           if (captainRegex.test(name)) {
             displayName = name.replace(captainRegex, ' ').trim();
             badges += '<span class="captain-badge">C</span>';
           }
         
           const goalkeeperRegex = /\s*\(g\)\s*/i;
           if (goalkeeperRegex.test(name)) {
             displayName = name.replace(goalkeeperRegex, ' ').trim();
             badges += '<span class="goalkeeper-badge">üß§</span>';
           }
         
           return displayName + badges;
         }
         
         const teamImage = document.querySelector(".team-image");
         const overlay = document.getElementById("imageOverlay");
         const preview = document.getElementById("imagePreview");
         
         if (teamImage) {
         teamImage.addEventListener("click", () => {
         preview.src = teamImage.src;
         overlay.style.display = "flex";
         });
         }
         
         overlay.addEventListener("click", (e) => {
         if (e.target === overlay || e.target.classList.contains("overlay-close")) {
         overlay.style.display = "none";
         }
         });
         document.addEventListener("keydown", (e) => {
         if (e.key === "Escape") {
         overlay.style.display = "none";
         }
         });
         
         
         /* ---------------- UPDATE SORT INDICATORS ---------------- */
         function updateSortIndicators() {
           const { field, dir } = currentSort;
         
           document.querySelectorAll("th[data-sort]").forEach(th => {
             th.classList.remove('sorted-asc', 'sorted-desc');
             if (th.dataset.sort === field) {
               th.classList.add(dir === 'asc' ? 'sorted-asc' : 'sorted-desc');
             }
           });
         }
         
         /* ---------------- RENDER ---------------- */
         function renderTable(data) {
           const tbody = document.getElementById("teamTable");
           tbody.innerHTML = "";
         
           let list = Object.entries(data)
             .map(([id, p]) => ({
               id,
               name: p.name || "",
               goals: Number(p.goals) || 0,
               matches: Number(p.matches) || 0
             }));
         
           list.sort((a, b) => {
             const f = currentSort.field;
         
             if (f === 'name') {
               const nameA = a.name.replace(/\s*\(c\)\s*/gi, '').replace(/\s*\(g\)\s*/gi, '').trim().toLowerCase();
               const nameB = b.name.replace(/\s*\(c\)\s*/gi, '').replace(/\s*\(g\)\s*/gi, '').trim().toLowerCase();
               return currentSort.dir === "asc"
                 ? nameA.localeCompare(nameB, 'sr')
                 : nameB.localeCompare(nameA, 'sr');
             } else {
               if (a[f] === b[f]) {
                 const nameA = a.name.replace(/\s*\(c\)\s*/gi, '').replace(/\s*\(g\)\s*/gi, '').trim().toLowerCase();
                 const nameB = b.name.replace(/\s*\(c\)\s*/gi, '').replace(/\s*\(g\)\s*/gi, '').trim().toLowerCase();
                 return nameA.localeCompare(nameB, 'sr');
               }
               return currentSort.dir === "asc" ? a[f] - b[f] : b[f] - a[f];
             }
           });
         
           list.forEach(p => {
             tbody.innerHTML += `
               <tr>
                 <td data-label="Igraƒç">${formatPlayerName(p.name)}</td>
                 <td data-label="Utakmice"><strong>${p.matches}</strong></td>
                 <td data-label="Golovi"><strong>${p.goals}</strong></td>
               </tr>
             `;
           });
         
           updateSortIndicators();
         }
         
         /* ---------------- LOAD ---------------- */
         onValue(window.dbRef("players/plavi"), snap => {
           playersData = snap.val() || {};
           renderTable(playersData);
         });
         
         /* ---------------- SORT ---------------- */
         document.addEventListener("DOMContentLoaded", () => {
           document.querySelectorAll("th[data-sort]").forEach(th => {
             th.onclick = () => {
               const field = th.dataset.sort;
         
               if (currentSort.field === field) {
                 currentSort.dir = currentSort.dir === "asc" ? "desc" : "asc";
               } else {
                 currentSort.field = field;
                 currentSort.dir = field === 'name' ? 'asc' : 'desc';
               }
         
               renderTable(playersData);
             };
           });
         });
         
      </script>
   </body>
</html>
